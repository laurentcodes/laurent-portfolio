---
import { TinaMarkdown } from 'tinacms/dist/rich-text';

import { client } from '../../../tina/__generated__/client';

import '@fontsource/roboto-mono';

import '../../styles/cms.css';

import Layout from '../../layouts/Layout.astro';

const { post } = Astro.params;

const url = Astro.url.href;

const singlePostRes = await client.queries.post({ relativePath: `${post}.md` });
const singlePost = singlePostRes.data.post;

const originalDate = new Date(singlePost.posted);
const dateFormatter = new Intl.DateTimeFormat('en-US', {
	month: 'long',
	day: 'numeric',
	year: 'numeric'
});

const formattedDate = dateFormatter.format(originalDate);
---

<Layout
	title={`Laurent. | Blog - ${singlePost.title}`}
	description={singlePost.summary}
	url={url}
>
	<main
		class='md:px-36 md:py-12 flex flex-col h-[calc(100vh-150px)] justify-between'
	>
		<div>
			<h3 class='text-red-500 text-3xl font-bold'>{singlePost.title}</h3>
			<p class='text-gray-500'>{formattedDate}</p>
		</div>

		<div class='cms-content my-12'>
			<TinaMarkdown content={singlePost.body} />
		</div>

		{
			singlePost.tags && (
				<div class='flex'>
					<p class='font-bold mr-2'>TAGS:</p>

					{singlePost.tags.map((tag, index) => (
						<p class='text-blue-400'>
							{index ? ',' : ''}
							{tag}
						</p>
					))}
				</div>
			)
		}
	</main>
</Layout>
